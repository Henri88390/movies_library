<div class="movies-container">
  <button
    *ngIf="authService.user$ | async"
    class="create-movie-btn"
    (click)="handleCreateMovie()"
  >
    ➕ Add New Movie
  </button>

  <div class="loading" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading movies...</p>
  </div>

  <div class="error" *ngIf="error">
    <p>❌ {{ error }}</p>
    <button (click)="loadMovies()" class="retry-btn">Try Again</button>
  </div>

  <div class="movies-grid" *ngIf="!loading && !error">
    <app-movie-card
      *ngFor="let movie of movies"
      (cardClick)="handleCardClick(movie)"
      (deleteClick)="handleDeleteClick(movie)"
      [movie]="movie"
      [isLoggedIn]="!!(authService.user$ | async)"
    >
    </app-movie-card>
  </div>

  <div class="empty-state" *ngIf="!loading && !error && movies.length === 0">
    <h2>📽️ No movies found</h2>
    <p>Your movie library is empty. Add some movies to get started!</p>
    <button
      *ngIf="authService.user$ | async"
      class="create-movie-btn"
      (click)="handleCreateMovie()"
    >
      ➕ Create Your First Movie
    </button>
  </div>

  <!-- Edit Modal - Only for logged users -->
  <app-movie-edit-modal
    *ngIf="authService.user$ | async"
    [isOpen]="isEditModalOpen"
    [movie]="currentMovie"
    (movieUpdated)="handleMovieUpdated($event)"
    (closeModal)="handleCloseModal()"
  />

  <!-- Create Modal - Only for logged users -->
  <app-movie-create-modal
    *ngIf="authService.user$ | async"
    [isOpen]="isCreateModalOpen"
    (movieCreated)="handleMovieCreated($event)"
    (closeModal)="handleCloseCreateModal()"
  />

  <app-movie-delete-modal
    [isOpen]="isDeleteModalOpen"
    [movie]="movieToDelete"
    (movieDeleted)="handleMovieDeleted($event)"
    (closeModal)="handleCloseDeleteModal()"
  />
</div>
